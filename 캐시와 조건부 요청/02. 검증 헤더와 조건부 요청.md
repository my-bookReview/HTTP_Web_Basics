# 검증 헤더와 조건부 요청

`캐시 유효 시간이 초과 해 서버에 다시 요청하면 다음 두 가지 상황이 나타납니다.`

1. 서버에서 기존 데이터를 변경함. `별 (노란색 색상 -> 연두색 색상)` 
2. 서버에서 기존 데이터를 변경하지 않음. `별 (노란색)`


캐시 시간 초과.

- `캐시 만료 후 서버에서 데이터를 변경하지 않음.`
- `생각해보면 데이터를 전송하는 대신 저장해 두었던 캐시를 재사용 할 수 있다.`
- 단 클라이언트의 데이터와 서버의 데이터가 같다는 사실을 확인할 수 있는 방법 필요.


검증 헤더 추가.

캐시 이런 것 없이 처음 요청. /star.jpg 클라이언트에서 요청.
서버에서 수정된 시간 보내줌.

``` javascript
Content-Type: image/jpeg
cache-control: max-age=60
Last-Modified: 2020년 11월 10일 10:00:00
Content-Length: 34012
```

응답 결과를 캐시에 저장.
데이터 최종 수정일 2020년 11월10일 10:00:00 
브라우저 캐시 60초 유효.


60초가 지나면, `http 요청을 보낼 떄 다시 서버에 요청을 보내야 합니다.`
`last-modified` 가 있으면 `if-modified-since` 를 붙인 다음 날짜를 붙여 줍니다.

``` javascript
GET /star.jpg
if-modified-since: 2020년 11월 10일 10:00:00 (캐시가 가지고 있는, 데이터 최종 수정일) 
```

이 데이터 수정이 된 나 안됫나 서버에서 검증 할 수 있습니다.
서버에서는 날짜를 보고 판단 할 수 있습니다.

아직 그냥 써도 돼. 변경 된 것 없어. -> 수정이 안되면 HTTP/1.1 304 Not Modified 

0.1M 전송 (HTTP Body 전송 X) 

``` javascript
HTTP/1.1 304 Not Modified 
Content-Type: image/jpeg 
... 
// HTTP Body가 없음. 
```
