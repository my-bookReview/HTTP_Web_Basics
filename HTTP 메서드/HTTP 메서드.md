# HTTP 메서드



## HTTP API 를 관찰하는 사람

URI 는 리소스를 식별.
리소스의 의미 - 회원을 등록하고 수정하고 조회하는 것이 리소스가 아닙니다.

예) 미네랄을 캐라 -> 미네랄이 리소스.
회원이라는 개념 자체가 바로 리소스다.

리소스를 어떻게 식별하는 게 좋을까?

- 회원을 등록하고 수정하고 조회하는 것을 모두 배제.
- 회원이라는 리소스만 식별하면 된다. -> 회원 리소스를 URI 에 매핑.

회원 목록 조회 /members
회원 조회 /members/{id} -> 어떻게 구분하지?
회원 등록 /members/{id} -> 어떻게 ..
회원 수정 /members/{id}
회원 삭제 /members/{id}


리소스와 행위를 분리.
-> 가장 중요한 것은 리소스를 식별하는 것.

URI 는 리소스만 식별.
리소스와 해당 리소스를 대상으로 하는 행위를 분리.
    - 리소스 : 회원.
    - 행위 : 조회, 등록, 삭제, 변경.




## HTTP 메서드 - GET, POST 

HTTP 메서드는 GET 달라, POST 데이터를 넣을 테니 등록.

GET : 리소스 조회.
POST : 요청 데이터 처리, 주로 등록에 사용.
PUT : 리소스를 대체, 해당 리소스가 없으면 생성.
PATCH : 리소스 부분 변경.
DELETE : 리소스 삭제.




POST

- 요청 데이터 처리.
- 메시지 바디를 통해 서버로 요청 데이터 전달.
- 서버는 요청 데이터를 처리. (메시지 바디를 통해 드러온 데이터를 처리하는 모든 기능을 수행 합니다)

HTML 양식에 입력 된 필드와 같은 데이터 블록을 데이터 처리 프로세스에 제공.

1. 새 리소스 생성(등록)
    - 서버가 아직 식별하지 않은 새 리소스 생성.

2. 요청 데이터 처리.
    - 단순 데이터를 생성, 변경하는 것을 넘어 프로세스를 처리해야 하는 경우.
    - 예) 주문에서 결제 완료 -> 배달시작 -> 배달완료 처럼 단순 값 변경을 넘어 프로세스의 상태가 변경되는 경우.
    - POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음.

3. 다른 메서드로 처리하기 애매한 경우.
    - JSON 으로 조회 데이터를 넘겨야 하는 데, GET 메서드를 사용하기 어려운 경우.
    - 애매하면 POST 



## HTTP 메서드 - PUT, PATCH, DELETE

PUT 은 리소스를 대체.

    - 리소스가 있으면 대체.
    - 리소스가 없으면 생성.
    - 쉽게 이야기해서 덮어버림.

중요 ! 클라이언트가 리소스를 식별.

    - 클라이언트가 리소스 위치를 알고 URI 지정.
    - POST 와 차이점.

기존 데이터를 대체 시켜 버림. 
리소스가 없으면? 들어가서 신규 리소스가 생성 됩니다.

근데 기존에는 username, age 를 던져줘야 하는데
클라이언트에서 username 만 던져준다면 username 으로 덮어씌어 버림.

뭔가 리소스를 수정하기 되게 어렵습니다.




`PATCH 를 사용하면 됩니다.`

PATCH 로 보내게 되면 age: 50 -> username, age 
`age만 50으로 변경됩니다.`

DELETE 리소스 제거.




## HTTP 메서드 속성

안전(Safe Methods)
멱등(Idempotent Methods)
캐시가능(Caacheable Methods)

안전 Safe 

호출해도 리소스를 변경하지 않는다.
그래도 계속 호출해서, 로그 같은게 쌓여서 장애가 발생하면요?
안전은 해당 리소스만 고려한다. 그런 부분까지 고려하지 않는다.

로그가 쌓여서 서버에 장애가 날 수 있지 않나요?
안전은 그런 문제까지 고려하지 않습니다.

로그가 쌓아셔 장애가 나고 그런 것까지 고려 x
 

리소스가 변하지 않는다로 이해하기


멱등 Idempotent 

한 번 호출, 백 번 호출하든 결과가 똑같습니다.

GET : 어자피 조회만 하는 거라 백번 호출해도 똑같음.
PUT : 똑같은 파일을 똑같이 요청을 합니다.
DELETE : 같은 요청을 여러 번 해도 삭제는 결과는 똑같음.
POST : 사장님이 배송 두 번 눌러도 오류. 결제가 중복해서 발생 할 수 있음.

`멱등은 외부 요인으로 중간에 리소스가 변경되는 것 까지는 고려하지 않습니다.`



캐시가능 Cacheable 

응답 결과 리소스를 캐시해서 사용해도 되는가?
GET, HEAD, POST, PATCH 캐시가능.
실제로는 GET, HEAD 정도만 캐리로 사용. -> POST, PATCH 는 본문 내용까지 캐시 키로 고려해야 하는데, 구현이 쉽지 않음.

